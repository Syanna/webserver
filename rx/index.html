<html>

<script>
// when the page loads, populate the fields based on XML
window.onload = function() {
	load_xml('A');	
// 	if ( get_uhd() == 0 )
// 		load_xml('A');
// 	else {
// 		document.getElementById("chan_en").src="../images/off.svg";
// 		document.getElementById("chan_en").disabled=true;
// 		chan_pwr(0);
// 	}
}

// checking to see if UHD mode is enabled
// enabled - all buttons and fields will be greyed output
// disabled - normal operation for all webpages
function get_uhd() {
	var xmlDoc;
	var xmlload;
	var ele;
	if (window.XMLHttpRequest) {
		xmlload=new XMLHttpRequest();
	} else {
		xmlload=new ActiveXObject("Microsoft.XMLHTTP");
	}
	xmlload.onreadystatechange=function() {
	   if (xmlload.readyState==4 && xmlload.status==200) {
	      xmlDoc = xmlload.responseXML;
	      ele=xmlDoc.getElementsByTagName("opr");
	      if (ele[i].childNodes[(2*2)+1].firstChild.nodeValue == "ON")
					return 1;
				else 
					return 0;
	   }
	}
	
	xmlload.open("GET","../dig/state_current.xml",true);
	xmlload.send();
} 


// for each channel, helper function
function populate_fields(chan, ele) {
	var i;
	for (i = 0; i < ele.length; i++) {
		if (ele[i].childNodes[1].firstChild.nodeValue == "CHAN_EN" + chan) {
			if (ele[i].childNodes[(1*2)+1].firstChild.nodeValue == "ON") {
				document.getElementById("chan_en").src="../images/on.svg";
				chan_pwr(1);
			} else {
				document.getElementById("chan_en").src="../images/off.svg";
				chan_pwr(0);
				break;
			}
		}
		else if (ele[i].childNodes[1].firstChild.nodeValue == "ADC16DX370_CH" + chan) {
			if (ele[i].childNodes[(1*2)+1].firstChild.nodeValue == "ON")
				document.getElementById("pwr_adc").src="../images/on.svg";
			else
				document.getElementById("pwr_adc").src="../images/off.svg";
		}
		else if (ele[i].childNodes[1].firstChild.nodeValue == "VARACTOR_CH" + chan) {
			document.getElementById("rf_v").value=ele[i].childNodes[(2*2)+1].firstChild.nodeValue;
		}
		else if (ele[i].childNodes[1].firstChild.nodeValue == "ADRF6518_CH" + chan) {
			document.getElementById("vga_g").value=ele[i].childNodes[(2*2)+1].firstChild.nodeValue;
			if (ele[i].childNodes[(1*2)+1].firstChild.nodeValue == "ON") {
				document.getElementById("pwr_adrf").src="../images/on.svg";
				document.getElementById("vga_g").disabled			=false;
			} else {
				document.getElementById("pwr_adrf").src="../images/off.svg";
				document.getElementById("vga_g").disabled			=true;
			}
		}
		else if (ele[i].childNodes[1].firstChild.nodeValue == "HMC_CH" + chan) {
			document.getElementById("rf_f").value=ele[i].childNodes[(2*2)+1].firstChild.nodeValue;
			if (ele[i].childNodes[(1*2)+1].firstChild.nodeValue == "ON") {
				document.getElementById("pwr_hmc").src="../images/on.svg";
				document.getElementById("rf_f").disabled			=false;
				document.getElementById("set_rf_f").disabled	=false;	
			} else {
				document.getElementById("pwr_hmc").src="../images/off.svg";
				document.getElementById("rf_f").disabled			=true;
				document.getElementById("set_rf_f").disabled	=true;
			}
		}
		else if (ele[i].childNodes[1].firstChild.nodeValue == "BAND_SW_CH" + chan) {
			if (ele[i].childNodes[(2*2)+1].firstChild.nodeValue == "HIGH") {
				document.getElementById("rf_b1").checked="true";
				document.getElementById("rf_b3").checked="true";
				document.getElementById("img_band_sw").src="../images/rx_high.svg";
			} else {
				document.getElementById("rf_b2").checked="true";
				document.getElementById("rf_b4").checked="true";
				document.getElementById("img_band_sw").src="../images/rx_low.svg";
			}
		}
		else if (ele[i].childNodes[1].firstChild.nodeValue == "LNA_SW_CH" + chan) {
			if (ele[i].childNodes[(2*2)+1].firstChild.nodeValue == "OFF") {
				document.getElementById("rf_l1").checked="true";
				document.getElementById("img_lna_sw").src="../images/rx_by.svg";
			} else {
				document.getElementById("rf_l2").checked="true";
				document.getElementById("img_lna_sw").src="../images/rx_lna.svg";
			}
		}
		else if (ele[i].childNodes[1].firstChild.nodeValue == "DEC_FACT" + chan) {
			populate_decim();
			document.getElementById("decim").value=ele[i].childNodes[(1*2)+1].firstChild.nodeValue;
		}
		else if (ele[i].childNodes[1].firstChild.nodeValue == "DEST_IP" + chan) {
			document.getElementById("dest_ip").value=ele[i].childNodes[(1*2)+1].firstChild.nodeValue;
		}
		else if (ele[i].childNodes[1].firstChild.nodeValue == "DEST_MAC" + chan) {
			document.getElementById("mac_addr").value=ele[i].childNodes[(1*2)+1].firstChild.nodeValue;
		}
		else if (ele[i].childNodes[1].firstChild.nodeValue == "DEST_UDP" + chan) {
			document.getElementById("udp_port").value=ele[i].childNodes[(1*2)+1].firstChild.nodeValue;
		}
		else if (ele[i].childNodes[1].firstChild.nodeValue == "DEST_PORT" + chan) {
			if (chan == "A" || chan == "C")
					document.getElementById("sfp_port").innerHTML = "10GbE SFP+ Port A";
			else
					document.getElementById("sfp_port").innerHTML = "10GbE SFP+ Port B";
					
			if (ele[i].childNodes[(1*2)+1].firstChild.nodeValue == "SFPA") {
				document.getElementById("dsp_d1").checked="true";
				if (document.getElementById("chan_en").src.indexOf("on.svg") > -1) {
					document.getElementById("dest_ip").disabled		=false;
					document.getElementById("mac_addr").disabled	=false;
					document.getElementById("udp_port").disabled	=false;
					document.getElementById("set_destip").disabled=false;
					document.getElementById("set_mac").disabled		=false;
					document.getElementById("set_udp").disabled		=false;
				}
				document.getElementById("img_dest_sw").src="../images/rx_sfpa.svg";
			} else if (ele[i].childNodes[(1*2)+1].firstChild.nodeValue == "SFPB") {
				document.getElementById("dsp_d1").checked="true";
				if (document.getElementById("chan_en").src.indexOf("on.svg") > -1) {
					document.getElementById("dest_ip").disabled		=false;
					document.getElementById("mac_addr").disabled	=false;
					document.getElementById("udp_port").disabled	=false;
					document.getElementById("set_destip").disabled=false;
					document.getElementById("set_mac").disabled		=false;
					document.getElementById("set_udp").disabled		=false;
				}
				document.getElementById("img_dest_sw").src="../images/rx_sfpa.svg";
			} else {
				document.getElementById("dsp_d2").checked="true";
				if (document.getElementById("chan_en").src.indexOf("off.svg") > -1) {
					document.getElementById("dest_ip").disabled		=true;
					document.getElementById("mac_addr").disabled	=true;
					document.getElementById("udp_port").disabled	=true;
					document.getElementById("set_destip").disabled=true;
					document.getElementById("set_udp").disabled		=true;
				}
				document.getElementById("img_dest_sw").src="../images/rx_txlpbk.svg";
			}
		}
		else if (ele[i].childNodes[1].firstChild.nodeValue == "SIGNED" + chan) {
			if (ele[i].childNodes[(1*2)+1].firstChild.nodeValue == "SIGNED") {
				document.getElementById("dsp_sgn1").checked="true"
			} else {
				document.getElementById("dsp_sgn2").checked="true"
			}
		}
		else if (ele[i].childNodes[1].firstChild.nodeValue == "FREQ_ADJ" + chan) {
			if (ele[i].childNodes[(1*2)+1].firstChild.nodeValue == "-") {
				document.getElementById("dsp_p").value = "00002000";
			} else {
				document.getElementById("dsp_p").value = "00000000";
			}
			document.getElementById("dsp_f").value=ele[i].childNodes[(2*2)+1].firstChild.nodeValue;
		}
		else if (ele[i].childNodes[1].firstChild.nodeValue == "SAMPLE_RATE" + chan) {
			document.getElementById("msps").innerHTML=ele[i].childNodes[(1*2)+1].firstChild.nodeValue;
		}
		
	}
}


// load the xml
function load_xml(chan) {
	var xmlDoc;
	var xmlload;
	var ele;
	if (window.XMLHttpRequest) {
		xmlload=new XMLHttpRequest();
	} else {
		xmlload=new ActiveXObject("Microsoft.XMLHTTP");
	}
	xmlload.onreadystatechange=function() {
	   if (xmlload.readyState==4 && xmlload.status==200) {
	      xmlDoc = xmlload.responseXML;
	      ele=xmlDoc.getElementsByTagName("radio");
	      populate_fields(chan, ele);
	      ele=xmlDoc.getElementsByTagName("fpga");
	      populate_fields(chan, ele);
	   }
	}
	
	xmlload.open("GET","state_current.xml",true);
	xmlload.send();
}


// writing states to xml
function write_xml(ft, attr, val) {
	
	// perl script takes this param = brd, chain, name, chan, attr, val
	// @brd = rx
	// @ft = name of state to be changed (ie. SAMPLE_RATE, FREQ_ADJ...)
	// @attr = attribute to be changed
	// @val = new state value
	
	var channel = document.getElementsByName("chan");
	var sel_ch;
	for (var i = 0; i < channel.length; i++) {
		if (channel[i].checked){
			sel_ch = channel[i].value;
		}
	}
	var ch_cal = sel_ch.toUpperCase();
	var sep = ",";
	var brd = "rx";
	var param = brd.concat(sep,ft,ch_cal,sep,attr,sep,val);
	
	runscript("invoke_xmlprsr.sh", param, "dump_out", "box");
}


// send command to the MCU
function sendcmd(board, str) {
	var xmlhttp;
	if (str.length==0) return;
	document.getElementById("dump_out").innerHTML="";
	
 	// code for IE7+, Firefox, Chrome, Opera, Safari
	if (window.XMLHttpRequest)
		xmlhttp=new XMLHttpRequest();
	else 				// code for IE6, IE5
		xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");

	xmlhttp.onreadystatechange=function() {
		if (xmlhttp.readyState==4 && xmlhttp.status==200) {
			document.getElementById("dump_out").innerHTML+=xmlhttp.responseText;
		}
	}

	if(str.indexOf("-c a") > -1) {
		var elements = document.getElementsByName("chan");
		for (var i = 0; i < elements.length; i++) {
			if (elements[i].checked) {
				str = str.replace("-c a", "-c "+elements[i].value);
			}
		}
	}

	if (board == "DIG") {
		xmlhttp.open("POST","../cgi-bin/cmd_mcu.sh", true);
		xmlhttp.send(str);
	} else if (board == "SYNTH") {
		xmlhttp.open("POST","../cgi-bin/fcmd_mcu.sh", true);
		xmlhttp.send("fwd -b 2 -m \'"+str+"\'");
	} else if (board == "TX") {
		xmlhttp.open("POST","../cgi-bin/fcmd_mcu.sh", true);
		xmlhttp.send("fwd -b 1 -m \'"+str+"\'");
	} else if (board == "RX") {
		xmlhttp.open("POST","../cgi-bin/fcmd_mcu.sh", true);
		xmlhttp.send("fwd -b 0 -m \'"+str+"\'");
	}
}


// update an image on the screen
function new_img(str, img) {
	document.getElementById(str).src=img;
}


// invoke shell script
function runscript(script, param, output, type) {
	var xmlhttp;
	if (type == "box")
		document.getElementById(output).innerHTML="";
	else
		document.getElementById(output).value="";

	if (window.XMLHttpRequest)
		xmlhttp=new XMLHttpRequest();
	else
		xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");

	xmlhttp.onreadystatechange=function() {
		if (xmlhttp.readyState==4 && xmlhttp.status==200) {
			if (type == "box")
				document.getElementById(output).innerHTML += xmlhttp.responseText;
			else
				document.getElementById(output).value += xmlhttp.responseText;
		}
	}

	xmlhttp.open("POST","../cgi-bin/"+script, true);
	xmlhttp.send(param);
}

// ==========================
// Channel Power functions
// ==========================
tx_en = [];	// indicates which tx channel is enabled
rx_en = [];	// indicates which rx channel is enabled

// when someone presses the power button which does register manipulation
/* RX channel Disable:
/*		- everything greys
/*		- demo mode
/*		- mem wr defaults
/*				> rxa0 - 0x0 phase
/*				> rxa1 - 0xff decimation
/*				> rxa4 - 0x0
/*		- copy xml file to reset
/* RX channel Enable:
/*		- everything ungreys
/*		- (already in demo mode): 
/*				> scan which TX/RX channels are enabled
/*				> set all ADCs to demo mode 
/*				> mem wr disable rx channels
/*				> mem wr disable tx channels
/*				> set all DACs to demo mode  
/*				> send sysref
/*		- mem wr EN to all channels which were enabled
*/
function chpwr_button(board, reg_num, mask, val_on, val_off) {
	
	var mode, sel_ch, channel, i;
	
	// Checking for current channel
	channel = document.getElementsByName("chan");
	for (i = 0; i < channel.length; i++) {
		if (channel[i].checked){
			sel_ch = channel[i].value;
		}
	}
	sel_ch = sel_ch.toUpperCase();
	
	
	// Chain is Disabled
	if (document.getElementById("chan_en").src.indexOf("on.svg") > -1) {
			mode = 0;
			
			// Grey out features
			document.getElementById("chan_en").src="../images/off.svg";
			chan_pwr(0);

			var sep = ",";	// declaring seperator
			var param = "rx".concat(sep,sel_ch,sep,mode);
			setTimeout(function() { runscript("channel_pwr.sh", param, "dump_out", "box"); }, 	250);	
			
	} 

	// Chain is Enabled
	else {
			mode = 1;
			
			document.getElementById("chan_en").src="../images/on.svg";
			
			var sep = ",";	// declaring seperator
			var param = "rx".concat(sep,sel_ch,sep,mode);
			
			setTimeout(function() { runscript("channel_pwr.sh", param, "dump_out", "box"); }, 	500);	
			
			// Finally, un-grey features
			setTimeout(function() { load_xml(sel_ch); }, 	2000);
			
	}
}


// enable/disable entire channel (includes radio/dsp)
function chan_pwr(mode) {
	// Mode: 1-enable; 0-disable;
	if (mode) {
		// Radio Chain
		document.getElementById("rf_b1").disabled			=false;
		document.getElementById("rf_b2").disabled			=false;
		document.getElementById("rf_b3").disabled			=false;
		document.getElementById("rf_b4").disabled			=false;
		document.getElementById("rf_l1").disabled			=false;
		document.getElementById("rf_l2").disabled			=false;
		
		document.getElementById("pwr_hmc").src="../images/on.svg";
		document.getElementById("pwr_hmc").disabled		=false;
		document.getElementById("rf_f").disabled			=false;
		document.getElementById("set_rf_f").disabled	=false;
		
		document.getElementById("rf_v").disabled			=false;
		document.getElementById("set_var").disabled		=false;
		
		document.getElementById("pwr_adrf").src="../images/on.svg";
		document.getElementById("pwr_adrf").disabled	=false;
		document.getElementById("vga_g").disabled			=false;
		
		document.getElementById("pwr_adc").src="../images/on.svg";
		document.getElementById("pwr_adc").disabled		=false;
		
		// DSP
		document.getElementById("dsp_rst").disabled		=false;
		
		document.getElementById("dsp_p").disabled			=false;
		document.getElementById("dsp_f").disabled			=false;
		document.getElementById("set_nco_f").disabled	=false;
		
		document.getElementById("decim").disabled			=false;
		document.getElementById("set_decim").disabled	=false;
		document.getElementById("dsp_sgn1").disabled	=false;
		document.getElementById("dsp_sgn2").disabled	=false;
		
		document.getElementById("pkr_rst").disabled		=false;
		document.getElementById("dsp_d1").disabled		=false;
		document.getElementById("dsp_d2").disabled		=false;
		document.getElementById("dest_ip").disabled		=false;
		document.getElementById("mac_addr").disabled	=false;
		document.getElementById("udp_port").disabled	=false;
		document.getElementById("set_destip").disabled=false;
		document.getElementById("set_mac").disabled		=false;
		document.getElementById("set_udp").disabled		=false;
		
		// Board Control
		document.getElementById("jesd_sync").disabled	=false;
		
		document.getElementById("adc_test").disabled	=false;
		document.getElementById("adc_dump").disabled	=false;
		document.getElementById("adrf_test").disabled	=false;
		document.getElementById("adrf_dump").disabled	=false;
		document.getElementById("gpio_test").disabled	=false;
		document.getElementById("gpio_dump").disabled	=false;
		
		document.getElementById("b_init").disabled		=false;
		document.getElementById("b_demo").disabled		=false;
		document.getElementById("b_diag").disabled		=false;
		document.getElementById("b_mute").disabled		=false;
		document.getElementById("b_rst").disabled			=false;
		document.getElementById("b_kill").disabled		=false;
		document.getElementById("b_panic").disabled		=false;
		
// 		write_xml("CHAN_EN", "pwr", "ON");
	
	} else {
		// chain is disabled, grey out everything
		
		// Radio Chain
		document.getElementById("rf_b1").disabled			=true;
		document.getElementById("rf_b2").disabled			=true;
		document.getElementById("rf_b3").disabled			=true;
		document.getElementById("rf_b4").disabled			=true;
		document.getElementById("rf_l1").disabled			=true;
		document.getElementById("rf_l2").disabled			=true;
		
		document.getElementById("pwr_hmc").src="../images/off.svg";
		document.getElementById("pwr_hmc").disabled		=true;
		document.getElementById("rf_f").disabled			=true;
		document.getElementById("set_rf_f").disabled	=true;
		
		document.getElementById("rf_v").disabled			=true;
		document.getElementById("set_var").disabled		=true;
		
		document.getElementById("pwr_adrf").src="../images/off.svg";
		document.getElementById("pwr_adrf").disabled	=true;
		document.getElementById("vga_g").disabled			=true;
		
		document.getElementById("pwr_adc").src="../images/off.svg";
		document.getElementById("pwr_adc").disabled		=true;
		
		// DSP
		document.getElementById("dsp_rst").disabled		=true;
		
		document.getElementById("dsp_p").disabled			=true;
		document.getElementById("dsp_f").disabled			=true;
		document.getElementById("set_nco_f").disabled	=true;
		
		document.getElementById("decim").disabled			=true;
		document.getElementById("set_decim").disabled	=true;
		document.getElementById("dsp_sgn1").disabled	=true;
		document.getElementById("dsp_sgn2").disabled	=true;
		
		document.getElementById("pkr_rst").disabled		=true;
		document.getElementById("dsp_d1").disabled		=true;
		document.getElementById("dsp_d2").disabled		=true;
		document.getElementById("dest_ip").disabled		=true;
		document.getElementById("mac_addr").disabled	=true;
		document.getElementById("udp_port").disabled	=true;
		document.getElementById("set_destip").disabled=true;
		document.getElementById("set_mac").disabled		=true;
		document.getElementById("set_udp").disabled		=true;
		
		// Board Control
		document.getElementById("jesd_sync").disabled	=true;
		
		document.getElementById("adc_test").disabled	=true;
		document.getElementById("adc_dump").disabled	=true;
		document.getElementById("adrf_test").disabled	=true;
		document.getElementById("adrf_dump").disabled	=true;
		document.getElementById("gpio_test").disabled	=true;
		document.getElementById("gpio_dump").disabled	=true;
		
		document.getElementById("b_init").disabled		=true;
		document.getElementById("b_demo").disabled		=true;
		document.getElementById("b_diag").disabled		=true;
		document.getElementById("b_mute").disabled		=true;
		document.getElementById("b_rst").disabled			=true;
		document.getElementById("b_kill").disabled		=true;
		document.getElementById("b_panic").disabled		=true;
	
// 		write_xml("CHAN_EN", "pwr", "OFF");
	}

}

// ==========================
// Radio Specific functions
// ==========================
// when someone presses the power button
function pwr_button(board, id, str_on, str_off) {
	if (document.getElementById(id).src.indexOf("on.svg") > -1) {
		if ( id == "pwr_hmc" ) {
			document.getElementById("rf_f").disabled			=true;
			document.getElementById("set_rf_f").disabled	=true;
			write_xml("HMC_CH", "pwr", "OFF");
		} else if ( id == "pwr_adrf") {
			document.getElementById("vga_g").disabled			=true;
			write_xml("ADRF6518_CH", "pwr", "OFF");
		} else if ( id == "pwr_adc") {
			write_xml("ADC16DX370_CH", "pwr", "OFF");
		}
		document.getElementById(id).src="../images/off.svg";
		setTimeout(function() { sendcmd(board, str_off);}, 250);
	} else {
		if ( id == "pwr_hmc" ) {
			document.getElementById("rf_f").disabled			=false;
			document.getElementById("set_rf_f").disabled	=false;
			write_xml("HMC_CH", "pwr", "ON");
			setTimeout(function() { set_rf_freq() }, 350);
		} else if ( id == "pwr_adrf") {
			document.getElementById("vga_g").disabled			=false;
			write_xml("ADRF6518_CH", "pwr", "ON");
		} else if ( id == "pwr_adc") {
			write_xml("ADC16DX370_CH", "pwr", "ON");
		}
		document.getElementById(id).src="../images/on.svg";
		setTimeout(function() { sendcmd(board, str_on); }, 500);
		
		// after powering on the ADC, JESD Sync pulse needs to be sent
		if (id == "pwr_adc" )
				setTimeout(function() { sendcmd('DIG', 'fpga -o'); }, 700);
	}
}


// synchronize two radio buttons
function rad_sync(str1, str2) {
	if (str1.indexOf("rf_b") > -1) {
		if (str1.indexOf("1") > -1 || str1.indexOf("3") > -1) {
			document.getElementById("img_band_sw").src="../images/rx_high.svg";
			write_xml("BAND_SW_CH", "band", "HIGH");
		} else {
			document.getElementById("img_band_sw").src="../images/rx_low.svg";
			write_xml("BAND_SW_CH", "band", "LOW");
		}
	} else {
		if (str1.indexOf("1") > -1)
			document.getElementById("img_lna_sw").src="../images/rx_by.svg";
		else
			document.getElementById("img_lna_sw").src="../images/rx_lna.svg";
	}

	document.getElementById(str2).checked = document.getElementById(str1).checked;
}


// setting RF Frequency Synthesizer
function set_rf_freq() {
	var rf_freq = document.getElementById("rf_f").value;
	var channel = document.getElementsByName("chan");
	var sel_ch;
	for (var i = 0; i < channel.length; i++) {
		if (channel[i].checked){
			sel_ch = channel[i].value;
		}
	}
	sel_ch = sel_ch.toUpperCase();
	var sep = ".";	// declaring seperator
	var param = "rx".concat(sep,sel_ch,sep,rf_freq);
	runscript("freq_synth.sh", param, "dump_out", "box");
	//write_xml("HMC_CH", "freq", rf_freq);
	setTimeout(function() { load_xml(sel_ch); }, 250);
}

// setting ADRF6518 gain
function set_adrf6518_gain(gain) {
	document.getElementById("adrf6518_gain").innerHTML = gain + " dB";
	setTimeout(function() { write_xml("ADRF6518_CH", "gn", gain); }, 500);
	setTimeout(function() { sendcmd("RX", "vga -c a -g "+gain); }, 750);
}

// these settings match that of the MCU board_demo function
function board_demo() {

	var sel_ch;
	var channel = document.getElementsByName("chan");
	for (var i = 0; i < channel.length; i++) {
		if (channel[i].checked){
			sel_ch = channel[i].value;
		}
	}
	
	document.getElementById("vga_g").value = 45;		// gain = 45dB
	document.getElementById("vga_g").disabled = false;
	
	document.getElementById("pwr_adrf").src = "../images/on.svg";
	document.getElementById("pwr_adrf").disabled = false;
	
	document.getElementById("pwr_adc").src = "../images/on.svg";
	document.getElementById("pwr_adc").disabled = false;
	
	document.getElementById("pwr_hmc").src = "../images/on.svg";
	document.getElementById("rf_f").disabled = false;
	document.getElementById("set_rf_f").disabled = false;
	
	write_xml("ADRF6518_CH", "gn1", "1");
	setTimeout(function() { write_xml("ADRF6518_CH", "gn2", "1"); }, 100);
	setTimeout(function() { write_xml("ADRF6518_CH", "gn3", "1"); }, 200);
	setTimeout(function() { write_xml("ADRF6518_CH", "pgn", "1"); }, 300);
	setTimeout(function() { write_xml("ADRF6518_CH", "at1", "18"); }, 400);
	setTimeout(function() { write_xml("ADRF6518_CH", "at2", "18"); }, 500);
	setTimeout(function() { write_xml("ADRF6518_CH", "at3", "18"); }, 600);
	setTimeout(function() { write_xml("ADRF6518_CH", "freq", "63"); }, 700);
	setTimeout(function() { write_xml("ADRF6518_CH", "pwr", "ON"); }, 800);
	setTimeout(function() { write_xml("ADC16DX370_CH", "pwr", "ON"); }, 900);
	setTimeout(function() { write_xml("HMC_CH", "pwr", "ON"); }, 1000);
	setTimeout(function() { sendcmd('RX', 'board -c a -d'); }, 1100);
	
}


// ==========================
// FPGA/DSP functions
// ==========================
// writing to register
function reg_wr(board, reg_num, mask, value, output){
	
	var channel = document.getElementsByName("chan");
	var sel_ch;
	for (var i = 0; i < channel.length; i++) {
		if (channel[i].checked){
			sel_ch = channel[i].value;
		}
	}
	
	var reg_name = board.concat(sel_ch, reg_num);
	var sep = ".";	// declaring seperator
	var param = reg_name.concat(sep,mask,sep,value);
	runscript("reg_write.sh", param, "dump_out", "box");
}


// when someone presses the power button which does register manipulation
function pwr_button_reg(board, reg_num, mask, val_on, val_off, id) {
	if (document.getElementById(id).src.indexOf("on.svg") > -1) {
		// Disabling the Channel
		document.getElementById(id).src="../images/off.svg";
		
		// 1) Update FPGA register map
		reg_wr(board, reg_num, mask, val_off, id);
		
		if ( id == "chan_en" ) {
			chan_pwr(0);
			// 2) Power off channel and amplifiers (only applicable to "Channel Enable"
			setTimeout(function() { sendcmd("RX", "board -c a -d"); }, 500);
		}
		
	} else {
		// Enabling the Channel
		document.getElementById(id).src="../images/on.svg";
		
		if ( id == "chan_en" ) {
			chan_pwr(1);
			// 1) Put channel into Demo mode
			sendcmd("RX", "board -c a -d");
			// 2) Enable sync detection
			// 3) LMK "jesd -s"
			setTimeout(function() { sendcmd('DIG', 'fpga -o'); }, 500);
			// 4) Disable sync detection
			setTimeout(function() { sendcmd("RX", "board -c a -d"); }, 750);
		}
		
		// 5) Update FPGA register map
		setTimeout(function() { reg_wr(board, reg_num, mask, val_on, id); }, 1000);
	}
}


// setting NCO phase increment
function set_dsp_nco_f() {
	var p_inc = document.getElementById("dsp_f").value;
	var f_adc = 322265625;
	var mult = Math.pow(2,32);
	var f_nco = Math.round((p_inc * mult) / f_adc);
	var f_ncox = f_nco.toString(16);
	// setting the nco phase increment
	write_xml("FREQ_ADJ", "value", p_inc);
	setTimeout(function() { reg_wr("rx", "0", "00000000", f_ncox, "dsp_f"); }, 250);
	
	// setting the reverse phase
	var rev = document.getElementById("dsp_p");
	var rev_val = rev.options[rev.selectedIndex].value;
	setTimeout(function() { reg_wr("rx", "4", "ffffdfff", rev_val, "dsp_p"); }, 500);
	
	if ( rev_val == "00000000" )
		setTimeout(function() { write_xml("FREQ_ADJ", "dir", "-"); }, 750);
	else
		setTimeout(function() { write_xml("FREQ_ADJ", "dir", "+"); }, 750);
		
}


// populate the drop down menu for decimation:
function populate_decim(){
	var max=256;
	var real = document.getElementById('decim');

		real.options[0] = new Option('2', '2');
		real.options[1] = new Option('3', '3');
		for (var j = 0; j<max-1; j++) {
			real.options[j] = new Option(j+2,j+2);
		}
}


// writing to decimator register
function set_decim(){
	
	var channel = document.getElementsByName("chan");
	var sel_ch;
	for (var i = 0; i < channel.length; i++) {
		if (channel[i].checked){
			sel_ch = channel[i].value;
		}
	}
	
	var d = document.getElementById("decim").value;
	
	var curr_msps = 322.265625/d;
	curr_msps = curr_msps.toFixed(9);
	document.getElementById("msps").innerHTML = curr_msps;
	write_xml("SAMPLE_RATE", "value", curr_msps);

	
	var reg_name = "rx".concat(sel_ch, "1");
	var sep = ".";	// declaring seperator
	var param = reg_name.concat(sep,d);
	setTimeout(function () { write_xml("DEC_FACT", "value", d); }, 250);
	setTimeout(function () { runscript("dsp_reg_write.sh", param, "dump_out", "box"); }, 500);
	
}


// handling DSP destination port switching
function dest_port_handler() {

	var channel = document.getElementsByName("chan");
	var sel_ch;
	for (var i = 0; i < channel.length; i++) {
		if (channel[i].checked){
			sel_ch = channel[i].value; 
		}
	}

	if (document.getElementsByName("dsp_d")[0].checked) {
		document.getElementById("img_dest_sw").src="../images/rx_sfpa.svg"
		document.getElementById("dest_ip").disabled=false;
		document.getElementById("mac_addr").disabled=false;
		document.getElementById("udp_port").disabled=false;
		document.getElementById("set_destip").disabled=false;
		document.getElementById("set_mac").disabled=false;
		document.getElementById("set_udp").disabled=false;
		
		if ( sel_ch == "a" || sel_ch == "c") {
				write_xml("DEST_PORT", "port", "SFPA");
				setTimeout(function() { reg_wr("rx", "4", "ffffe1ff", "00000000", "dsp_d1"); }, 300);
		} else  if ( sel_ch == "b" || sel_ch == "d") {
				write_xml("DEST_PORT", "port", "SFPB");
				setTimeout(function() { reg_wr("rx", "4", "ffffe1ff", "00000200", "dsp_d1"); }, 300);
		}
		
	} else if (document.getElementsByName("dsp_d")[1].checked) {
		document.getElementById("img_dest_sw").src="../images/rx_txlpbk.svg";
		document.getElementById("dest_ip").disabled=true;
		document.getElementById("mac_addr").disabled=true;
		document.getElementById("udp_port").disabled=true;
		document.getElementById("set_destip").disabled=true;
		document.getElementById("set_mac").disabled=true;
		document.getElementById("set_udp").disabled=true;
		write_xml("DEST_PORT", "port", "LPBK");
		setTimeout(function() { reg_wr("rx", "4", "ffffe1ff", "00000400", "dsp_d2"); }, 300);
	}
}


// setting destination
function set_dest_ip() {
	var channel=document.getElementsByName("chan");
	var sel_ch;
	for (var i = 0; i < channel.length; i++) {
		if (channel[i].checked){
			sel_ch = channel[i].value;
		}
	}
	
	// Setting IPV4 destination IP
	var reg_name = "rx".concat(sel_ch, "5");
	var sep = ".";	// declaring seperator
	var ip = document.getElementById("dest_ip").value
	var param = reg_name.concat(sep, ip);
	write_xml("DEST_IP", "addr", ip);
	setTimeout(function() { runscript("set_destsrc_ip.sh", param, "dump_out", "box"); }, 200);
}


// setting dest mac address
function set_mac_addr() {
	var channel=document.getElementsByName("chan");
	var sel_ch;
	for (var i = 0; i < channel.length; i++) {
		if (channel[i].checked){
			sel_ch = channel[i].value;
		}
	}
	
	// Setting MAC address
	var reg_mac_u = "rx".concat(sel_ch, "6");
	var reg_mac_l = "rx".concat(sel_ch, "7");
	var mac = document.getElementById("mac_addr").value;
	var sep = ".";	// declaring seperator
	var param = reg_mac_u.concat(sep, reg_mac_l, sep, mac);
	setTimeout(function() { write_xml("DEST_MAC", "addr", mac); }, 400);
	setTimeout(function() { runscript("set_mac.sh", param, "dump_out", "box"); }, 600);
	
}


// setting dest udp port
function set_udp_port() {
	var channel=document.getElementsByName("chan");
	var sel_ch;
	for (var i = 0; i < channel.length; i++) {
		if (channel[i].checked){
			sel_ch = channel[i].value;
		}
	}
	
	// Setting UDP port
	var reg_udp = "rx".concat(sel_ch, "8");
	var port = document.getElementById("udp_port").value;
	var sep = ".";	// declaring seperator
	param = reg_udp.concat(sep, port);
	setTimeout(function() { write_xml("DEST_UDP", "port", port); }, 800);
	setTimeout(function() { runscript("set_udp.sh", param, "dump_out", "box"); }, 1000);
}
</script>


<!-- =============================== -->
<!-- HTML Code                       -->
<!-- =============================== -->
<!-- Header to switch to other pages -->
<head>
	<link rel="stylesheet" type="text/css" href="../pvstyle.css">
	<div id="head">
		<h1>
			<a href = "../"><input type="image" src="../images/PV1.png"></a>
			<a href = "../">Per Vices: RX Chain</a>
		</h1>
	</div>
	<div id="menu">
		<ul>
			<li><a href = "../rx">RX Chain</a></li>
			<li><a href = "../tx">TX Chain</a></li>
			<li><a href = "../synth">Clock</a></li>
			<li><a href = "../dig">Configuration</a></li>
			<li><a href = "../debug">Debug</a></li>
		</ul>
	</div>
</head>
<hr>
<body>

<p>This page allows the configuration of the entire receive chain from the RF front end to the digital backend. Select the channel that is being configured.</p>
<p>The signal is first sampled from the antenna which is connected to the SMA connector on the Crimson. The analog signal is fed through an RF switch based on the frequency of the signal being sampled. High band is reserved for signals greater than 500 MHz, and the low band is reserved for signals less than 500 MHz. Crimson currently supports signals up to 6 GHz. Within the respective RF chains (high and low) it filters the analog signal and divides it into I and Q channels for advanced signal processing on the FPGA. The high band offers an LNA for weaker signals, and a frequency mixer for desired intermediate frequencies prior to signal processing. The low band offers a varactor circuit to fine tune the delay between the I and Q channel. An ADC driver is common between both bands (high and low) prior to the ADC. The ADC will send the data across to the DSP chain within the FPGA at a rate of 322 MSPS using the JESD serial interface. The DSP chain will downsample the samples resulting in an adjusted final sample rate. The frequency of the signal can be adjusted prior to decimation.</p>

<table style="width:25%;">
	<!-- Channel Selection -->
	<tr><td>
		<b>Channel Selection:</b>
	</td><td>
		A <input id="chanA" type="radio" name="chan" value="a" onclick="load_xml('A')" checked="true">
	</td><td>
		B <input id="chanB" type="radio" name="chan" value="b" onclick="load_xml('B')">
	</td><td>
		C <input id="chanC" type="radio" name="chan" value="c" onclick="load_xml('C')">
	</td><td>
		D <input id="chanD" type="radio" name="chan" value="d" onclick="load_xml('D')">
	</td></tr>
	<tr><td>
		<!-- Enable RX Radio Chain -->
		<b>Channel Enable:</b>
	</td><td>	
		<input type="image" id="chan_en" src="../images/on.svg" 
		onclick="chpwr_button();">
	</td></tr>
</table>

<table>
	<!-- RADIO CONFIGURATION -->
	<tr><td style="position: relative;">
		<h2>RX Radio Chain</h2>
		<img src="rx_chain.svg" alt="Per Vices">
		
		<!-- RF switch animations -->
		<div style="position: absolute; left: 0px; top: 50px; z-index:-1;">
			<img id="img_band_sw">
		</div>
		<div style="position: absolute; left: 0px; top: 50px; z-index:-1;">
			<img id="img_lna_sw">
		</div>

		<!-- ADC16DX370 -->
		<div style="position: absolute; left: 1405px; top: 353px;">
			<input type="image" id="pwr_adc" src="../images/on.svg" onclick="pwr_button('RX', 'pwr_adc', 'power -c a -a 1', 'power -c a -a 0')">
		</div>

		<!-- ADRF6518 -->
		<div style="position: absolute; left: 1265px; top: 353px; ">
				<input type="image" id="pwr_adrf" src="../images/on.svg" onclick="pwr_button('RX', 'pwr_adrf', 'power -c a -d 1', 'power -c a -d 0')">
		</div><div style="position: absolute; left: 1240px; top: 405px; ">
			<input type="range" id="vga_g" min="0" max="95" step="1" onchange="set_adrf6518_gain(this.value)">
			<div id="adrf6518_gain" style="display:inline;">0 dB</div>
			<!--<table>
			<tr><td>
					1: Gain +<select id="vga_g">
						<option value="0">15</option>
						<option value="1">12</option>
						<option value="2">9</option>
					</select>dB,
					Atten -<input type="text" id="vga_x" size="2" maxlength="2">dB 
			</td><td>
					<button type="button" id="set_adrf1" style="width:52;" onclick="set_adrf6518_1();">Set</button></br>
			</td></tr>
			<tr><td>
					2: Gain +<select id="vga_h">
						<option value="0">21</option>
						<option value="1">18</option>
						<option value="2">15</option>
						<option value="3">12</option>
					</select>dB,
					Atten -<input type="text" id="vga_y" size="2" maxlength="2">dB
			</td><td>
					<button type="button" id="set_adrf2" style="width:52;" onclick="set_adrf6518_2();">Set</button></br>
			</td></tr>
			<tr><td>
					3: Gain +<select id="vga_i">
						<option value="0">21</option>
						<option value="1">18</option>
						<option value="2">15</option>
						<option value="3">12</option>
					</select>dB,
					Atten -<input type="text" id="vga_z" size="2" maxlength="2">dB
			</td><td>
					<button type="button" id="set_adrf3" style="width:52;" onclick="set_adrf6518_3();">Set</button></br>
			</td></tr>
			<tr><td>
					Post Gain: <select id="vga_p">
						<option value="0">3</option>
						<option value="1">9</option>
					</select>dB
			</td><td>
					<button type="button" id="set_adrf_pg" style="width:52;" onclick="set_adrf6518_pg();">Set</button>
			</td></tr>
			<tr><td>
					<input id="adrf_cf_by" type="checkbox" name="adrf_cf_by" value="0" onclick="set_adrf6518_cf();"> Corner Freq: <input type="text" id="vga_f" size="2" maxlength="2">MHz
			</td><td>
					<button type="button" id="set_adrf_cf" style="width:52;" onclick="set_adrf6518_cf();">Set</button>
			</td></tr>
			</table>-->
		</div>
		
		<!-- Varactor -->
		<div action="" style="position: absolute; left: 895px; top: 440px; ">
			<input type="text" id="rf_v" size="4" maxlength="5">clk cycles
			<button type="button" id="set_var" style="width:52;" onclick="">Set</button></br>
		</div>

		<!-- HMC frequency synthesizers -->
		<div action="" style="position: absolute; left: 685px; top: 346px; ">
			<input type="image" id="pwr_hmc" src="../images/on.svg" onclick="pwr_button('RX', 'pwr_hmc', 'power -c a -s 1', 'power -c a -s 0')">		
			<input type="text" id="rf_f" size="12" maxlength="7">KHz 
			<button type="button" id="set_rf_f" style="width:52;" onclick="set_rf_freq();">Set</button></br>
		</div>

		<!-- RF LNA switch -->
		<div action="" style="position: absolute; left: 550px; top: 50px; ">
			<input id="rf_l1" onclick="new_img('img_lna_sw', '../images/rx_by.svg');write_xml('LNA_SW_CH', 'lna', 'OFF');
			setTimeout(function() {sendcmd('RX', 'rf -c a -l 1')}, 250);" type="radio" name="rf_l" value="1">LNA Bypass</br>
			<input id="rf_l2" onclick="new_img('img_lna_sw', '../images/rx_lna.svg');write_xml('LNA_SW_CH', 'lna', 'ON');
			setTimeout(function() {sendcmd('RX', 'rf -c a -l 0')}, 250);" type="radio" name="rf_l" value="0">LNA Enable
		</div>

		<!-- RF band switch -->
		<div action="" style="position: absolute; left: 118px; top: 320px;">
			<input id="rf_b1" onclick="reg_wr('rx', '4', 'ffffff1f', '00000000', 'band_but');
			rad_sync('rf_b1', 'rf_b3'); sendcmd('RX', 'rf -c a -b 1');" 
			type="radio" name="rf_b" value="1">High Band</br>
			<input id="rf_b2" onclick="reg_wr('rx', '4', 'ffffff1f', '00000020', 'band_but');
			rad_sync('rf_b2', 'rf_b4');sendcmd('RX', 'rf -c a -b 0');"
			type="radio" name="rf_b" value="0">Low Band
		</div>
		<div action="" style="position: absolute; left: 1140px; top: 220px;">
			<input id="rf_b3" onclick="reg_wr('rx', '4', 'ffffff1f', '00000000', 'band_but');
			rad_sync('rf_b3', 'rf_b1');sendcmd('RX', 'rf -c a -b 1');"
			type="radio" name="rf_nb" value="1">High Band</br>
			<input id="rf_b4" onclick="reg_wr('rx', '4', 'ffffff1f', '00000020', 'band_but');
			rad_sync('rf_b4', 'rf_b2');sendcmd('RX', 'rf -c a -b 0');" 
			type="radio" name="rf_nb" value="0">Low Band</br>
		</div><button type="button" id="band_but" style="width:52;" hidden="hidden"></button></br>
		
		<!-- Predefined gains -->
		<div style="position: absolute; left: 270px; top: 220px; text-align:center;">G=15-23dB</br>Keep Below -10dBm</div>
		<div style="position: absolute; left: 490px; top: 460px; text-align:center;">G=20-21dB</br>Keep Below -3dBm</div>
		<div style="position: absolute; left: 525px; top: 235px; text-align:center;">G=15-16dB</br>Keep Below -3.8dBm</div>
		<div style="position: absolute; left: 955px; top: 205px; text-align:center;">LPF</div>
		</br></br></br>
	</td></tr>

	<!-- DSP CONFIGURATION -->
	<tr><td style="position: relative;">
		<h2>RX DSP Chain</h2></br>

		<img src="../dig/vaunt_dsp_rx.svg" alt="Per Vices">
		
		<div style="position: absolute; left: 0px; top: 68px; z-index:-1;">
			<img id="img_dest_sw">
		</div>
		
		<!-- DSP Reset -->
		<div style="position: absolute; left: 175px; top: 4px;">
			<button type="button" id="dsp_rst" style="width:52;";
				onclick="reg_wr('rx', '4', 'fffffffd', '00000002', 'dsp_rst');
				setTimeout(function(){reg_wr('rx', '4', 'fffffffd', '00000000', 'dsp_rst')}, 1200);">
				Reset</button></br>
		</div>
		
		<!-- Decimation -->
		<div style="position: absolute; left: 500px; top: 100;">
			Effective Output Sample Rate:</br>
			322.265625/ 
			<select id="decim">
				<option value="2">2</option>
			</select></br>
			<button type="button" id="set_decim" style="width:25;" onclick="set_decim();">=</button>
			<div id="msps" style="display:inline;"></div> MSPS</div></br>
		</div>
		
		<!-- DSP output Signed-ness -->
		<div action="" style="position: absolute; left: 500px; top: 180px; ">
			DSP Output Data:</br>
			<input id="dsp_sgn1" onclick="write_xml('SIGNED', 'sign', 'SIGNED'); 
				setTimeout(function(){reg_wr('rx', '4', 'ffffffef', '00000000', 'sgn_but')}, 500);"
				type="radio" name="dsp_sgn" value="0" checked="true">Signed</br>
			<input id="dsp_sgn2" onclick="write_xml('SIGNED', 'sign', 'UNSIGNED');
				setTimeout(function(){reg_wr('rx', '4', 'ffffffef', '00000010', 'sgn_but')}, 500);"
			type="radio" name="dsp_sgn" value="1">Unsigned<button type="button" id="sgn_but" style="width:52;" hidden></button></br>
		</div>
		
		<!-- Data Packer Reset -->
		<div style="position: absolute; left: 1036px; top: 145px;">
			<button type="button" id="pkr_rst" style="width:52;"
				onclick="reg_wr('rx', '4', 'fffffffe', '00000001', 'pkr_rst');
				setTimeout(function(){reg_wr('rx', '4', 'fffffffe', '00000000', 'pkr_rst')}, 500);" hidden>
				Reset</button>
		</div>
		
		<!-- DSP destination switch -->
		<div action="" style="position: absolute; left: 1050px; top: 69px; ">
			Destination Port:</br>
			<input id="dsp_d1" onclick="dest_port_handler();" 
			type="radio" name="dsp_d" value="0" checked="true">
			<div id="sfp_port" style="display:inline;"></div></br></br>
			<input id="dsp_d2" onclick="dest_port_handler();" 
			type="radio" name="dsp_d" value="2">Tx Chain (Loop Back)</br></br>
			<table>
				<tr><td>
					IPV4 IP Address: 
				</td><td>
					<input type="text" id="dest_ip" size="15" maxlength="15">
				</td><td>
					<button type="button" id="set_destip" style="width:52;" onclick="set_dest_ip();">Set</button>
				</td></tr>
				<tr><td>
					MAC Address:
				</td><td>
					<input type="text" id="mac_addr" size="15" maxlength="12">
				</td><td>
					<button type="button" id="set_mac" style="width:52;" onclick="set_mac_addr();">Set</button>
				</td></tr>
				<tr><td>
					UDP Port:
				</td><td>
					<input type="text" id="udp_port" size="15" maxlength="5">
				</td><td>
					<button type="button" id="set_udp" style="width:52;" onclick="set_udp_port();">Set</button>
				</td></tr>
			</table>
		</div>
		
		<!-- DSP NCO reverse phase -->
		<div style="position: absolute; left: 210px; top: 270px;">
			Phase Increment:</br>
			<select id="dsp_p">
				<option value="00002000" selected="selected">-</option>
				<option value="00000000">+</option>
			</select>
			<input type="text" id="dsp_f" size="10" maxlength="10">Hz
			<button type="button" id="set_nco_f" style="width:52;"
				onclick="set_dsp_nco_f();">Set</button>
		</div>
		
		</br></br></br></br>
	</td></tr>

	<!-- BOARD CONFIGURATION -->
	<tr><td style="position: relative;">
		</br>
		<h2>RX Board Control</h2>

		<table style="width:100%;">
			<tr><td valign="top">
				<b>JESD Sync.</b>
				<table>
					<tr>
						<td>
						<button type="button" id="jesd_sync" style="width:52;" onclick="sendcmd('DIG', 'fpga -o');">Sync</button>
						</td>
					</tr>
				</table></br>
				
				<b>Channel IC's</b>
				<table>
					<tr>
						<td>ADC</td>
						<td>ADRF</td>
						<td>GPIOX</td>
						<td>LED</td>
					</tr> <tr>
						<td><button type="button" id="adc_test" onclick="sendcmd('RX', 'test -c a -a')" style="width:60;">Test</button></td>
						<td><button type="button" id="adrf_test" onclick="sendcmd('RX', 'test -c a -d')" style="width:60;">Test</button></td>
						<td><button type="button" id="gpio_test" onclick="sendcmd('RX', 'test -c a -g')" style="width:60;">Test</button></td>
						<td><button type="button" id="led_test" onclick="sendcmd('RX', 'board -l 5')"   style="width:60;">Test</button></td>
					</tr> <tr>
						<td><button type="button" id="adc_dump" onclick="sendcmd('RX', 'dump -c a -a')" style="width:60;">Dump</button></td>
						<td><button type="button" id="adrf_dump" onclick="sendcmd('RX', 'dump -c a -v')" style="width:60;">Dump</button></td>
						<td><button type="button" id="gpio_dump" onclick="sendcmd('RX', 'dump -c a -g')" style="width:60;">Dump</button></td>
					</tr>
				</table> </br>

				<b>Channel State</b>
				<table>
					<tr>
						<td><button type="button" id="b_init" onclick="sendcmd('RX', 'board -c a -i')" style="width:60;">Init</button></td>
						<td><button type="button" id="b_demo" onclick="board_demo()" style="width:60;">Demo</button></td>
						<td><button type="button" id="b_diag" onclick="sendcmd('RX', 'board -c a -e')" style="width:60;">Diag</button></td>
						<td><button type="button" id="b_mute" onclick="sendcmd('RX', 'board -c a -m')" style="width:60;">Mute</button></td>
					</tr> <tr>
						<td><button type="button" id="b_rst" onclick="sendcmd('RX', 'board -c a -r')" style="width:60;">Reset</button></td>
						<td><button type="button" id="b_kill" onclick="sendcmd('RX', 'board -c a -k')" style="width:60;">Kill</button></td>
						<td><button type="button" id="b_panic" onclick="sendcmd('RX', 'board -c a -p')" style="width:60;">Panic</button></td>
					</tr>
				</table></br>
			</td> <td valign="top">
				<b>Board Version</b></br>
				<button type="button" onclick="sendcmd('RX', 'board -v')" style="width:60;">Get</button>&nbsp;&nbsp;
				Version: <div id="version_out"></div> </br>

				<b>Board Temperature</b></br>
				<button type="button" onclick="sendcmd('RX', 'board -c a -u')" style="width:60;">Get</button>&nbsp;&nbsp;
				Temperature (&deg;C): <div id="temp_out"></div>
			</td> <td valign="top">
				<b>Console Output</b></br>
				<textarea id="dump_out" rows="17" cols="90"></textarea></br>
			</td> </tr>
		</table>

	</td></tr>
</table>

</body>
<div id="footer">
<span style="font-size:11px;"> Copyright Per Vices 2014. All rights reserved.</span>
</div>
</html>
