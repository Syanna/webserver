<html>

<script>
window.onload = function() {
	/*var temp;
	if (window.XMLHttpRequest) {
		temp=new XMLHttpRequest();
	} else {
		temp=new ActiveXObject("Microsoft.XMLHTTP");
	}
	//temp.open("POST","../cgi-bin/clear_mcu.sh", true);
	//temp.send("");*/
};

function runscript(script, output) {
	var temp;
	if (window.XMLHttpRequest) {
		temp=new XMLHttpRequest();
	} else {
		temp=new ActiveXObject("Microsoft.XMLHTTP");
	}
	temp.onreadystatechange=function() {
		if (temp.readyState==4 && temp.status==200) {
			document.getElementById(output).innerHTML=temp.responseText;
		}
	}
	temp.open("POST","../cgi-bin/" + script, true);
	temp.send("");
}

function sendcmd(board, str) {
	var xmlhttp;
	if (str.length==0) return;

	document.getElementById('cmdout').innerHTML="";
	document.getElementById("cmdhistory").value+=str + "\n";

	if (window.XMLHttpRequest)	// code for IE7+, Firefox, Chrome, Opera, Safari
		xmlhttp=new XMLHttpRequest();
	else	// code for IE6, IE5
		xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");

	xmlhttp.onreadystatechange=function() {
		if (xmlhttp.readyState==4 && xmlhttp.status==200) {
			document.getElementById("cmdout").innerHTML+=xmlhttp.responseText;
		}
	}

	if (board == "DIG") {
		xmlhttp.open("POST","../cgi-bin/cmd_mcu.sh", true);
		xmlhttp.send(str);
	} else if (board == "SYNTH") {
		xmlhttp.open("POST","../cgi-bin/fcmd_mcu.sh", true);
		xmlhttp.send("fwd -b 2 -m \'"+str+"\'");
	} else if (board == "TX") {
		xmlhttp.open("POST","../cgi-bin/fcmd_mcu.sh", true);
		xmlhttp.send("fwd -b 1 -m \'"+str+"\'");
	} else if (board == "RX") {
		xmlhttp.open("POST","../cgi-bin/fcmd_mcu.sh", true);
		xmlhttp.send("fwd -b 0 -m \'"+str+"\'");
	}
}

</script>

<head>
	<link rel="stylesheet" type="text/css" href="../pvstyle.css">
	<div id="head">
		<h1>
			<a href = "../"><input type="image" src="../images/PV1.png"></a>
			<a href = "../">Per Vices: Debug</a>
		</h1>
	</div>
	<div id="menu">
		<ul>
			<li><a href = "../rx">RX Chain</a></li>
			<li><a href = "../tx">TX Chain</a></li>
			<li><a href = "../synth">Clock</a></li>
			<li><a href = "../dig">Configuration</a></li>
			<li><a href = "../debug">Debug</a></li>
		</ul>
	</div>
</head>
<hr>
<body>
<p> <b>This section is for experienced users who understand the raw commands to configure the boards. As of now, this feature should only be reserved for Per Vices for debugging purposes. Be aware that using this feature might cause the board to be in an improper state and result in a malfunction with the boards.</b></p>

<!-- IC information -->
<h2>IC Information</h2>
<table style="width:100%">
	<tr>
		<td><b>IC</b></td>
		<td><b>Description</b></td>
		<td><b>Purpose</b></td>
		<td><b>Datasheet</b></td>
		<td><b>Location</b></td>
	</tr> <tr>
		<td>AD5624R</td>
		<td>Quad 12-bit nanoDACs</td>
		<td>Voltage controlled attenuators, varactor, RF mixing</td>
		<td><a href="http://www.analog.com/static/imported-files/data_sheets/AD5624R_5644R_5664R.pdf" target="_blank">Datasheet</a></td>
		<td>TX, RX</td>
	</tr><tr>
		<td>ADC16DX370</td>
		<td>Dual 16-bit ADC with JESD204B</td>
		<td>RF IQ sampling</td>
		<td><a href="http://www.ti.com/lit/gpn/adc16dx370" target="_blank">Datasheet</a></td>
		<td>RX</td>
	</tr><tr>
		<td>ADRF6518</td>
		<td>Variable Gain Amplifier with Baseband Filter </td>
		<td>ADC driver before the ADC16DX370</td>
		<td><a href="http://www.analog.com/static/imported-files/data_sheets/ADRF6518.pdf" target="_blank">Datasheet</a></td>
		<td>RX</td>
	</tr><tr>
		<td>DAC38J84</td>
		<td>Quad 16-bit DAC with JESD204B</td>
		<td>RF IQ generator</td>
		<td><a href="http://www.ti.com/lit/gpn/dac38j84" target="_blank">Datasheet</a></td>
		<td>TX</td>
	</tr><tr>
		<td>GPIOX PCA9538</td>
		<td>8-bit GPIO Extender</td>
		<td>GPIO extender to 8 pins with I2C</td>
		<td><a href="http://www.nxp.com/documents/data_sheet/PCA9538.pdf" target="_blank">Datasheet</a></td>
		<td>TX, RX</td>
	</tr><tr>
		<td>HMC830LP6G</td>
		<td>Fractional-N PLL with VCO</td>
		<td>25-3000 MHz synthesizer to feed into HMC833LP6G</td>
		<td><a href="http://www.hittite.com/content/documents/data_sheet/hmc830lp6g.pdf" target="_blank">Datasheet</a></td>
		<td>TX, RX</td>
	</tr><tr>
		<td>HMC833LP6G</td>
		<td>Fractional-N PLL with VCO</td>
		<td>25-6000 MHz synthesizer for RF mixing on the high band RF chain</td>
		<td><a href="http://www.hittite.com/content/documents/data_sheet/hmc833lp6g.pdf" target="_blank">Datasheet</a></td>
		<td>TX, RX</td>
	</tr><tr>
		<td>HMC987LP5E</td>
		<td>Low Noise Fanout Buffer</td>
		<td>Clock buffer prior to fanout into daughter boards</td>
		<td><a href="https://www.hittite.com/content/documents/data_sheet/hmc987lp5e.pdf" target="_blank">Datasheet</a></td>
		<td>Synth</td>
	</tr><tr>
		<td>LMK04828</td>
		<td>Dual/Cascaded PLL</td>
		<td>Clock generation for all the boards</td>
		<td><a href="http://www.ti.com/lit/gpn/lmk04828" target="_blank">Datasheet</a></td>
		<td>Synth</td>
	</tr>
</table>

<!-- Bootloader programming -->
<h2>Programming via Bootloader</h2>
<form action="">
	Board: <select name="dac_e">
		<option value="r">TX</option>
		<option value="d">Digital</option>
		<option value="t">RX</option>
		<option value="s">Synth</option>
	</select></br>
	Hexfile: <input type="file" id="hexin">
	<button type="buttom" onclick="sendcmd('DIG', hexin.value)">Program Board</button>
</form>

<!-- CLI -->
<h2>Raw Command Line Interface</h2>
<form action="">
	Command: <input type="text" id="cmdin">
	<button type="button" onclick="sendcmd('DIG', cmdin.value)">Send Command</button>
	<!--<button type="button" onclick="sendcmd(cmdin.value);runscript('get_mculog.sh', 'cmdout');">Send Command</button>-->
</form>

<table>
	<tr>
		<td>Console Output</td>
		<td>Command History</td>
	</tr><tr>
		<td><textarea rows="20" cols="140" id="cmdout"></textarea></td>
		<td><textarea rows="20" cols="40" id="cmdhistory"></textarea></td>
	</tr>
</table>

</br>
</body>

<div id="footer">
	For more information and support, please visit our <a href="http://www.pervices.com/" target="_blank">site</a>.</br></br>
	<span style="font-size:11px;"> Copyright Per Vices 2014. All rights reserved.</span>
</div>
</html>
